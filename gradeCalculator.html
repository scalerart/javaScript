<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Grade Calculator</title>
  <style>
    * { box-sizing: border-box; }
    body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial; background:#0b1020; color:#eaf0ff; margin:0; padding:24px; }
    .app { max-width: 760px; margin: 0 auto; background: #101935; padding: 24px; border-radius: 16px; box-shadow: 0 10px 35px rgba(0,0,0,.35); }
    h1 { margin:0 0 12px; font-size: 28px; }
    p.sub { margin-top:0; color:#a9b5d1; }
    .field { margin:14px 0; }
    label { display:block; font-weight:600; margin-bottom:6px; }
    input[type="text"], input[type="number"] { width:100%; padding:12px 14px; border:1px solid #2a3355; background:#0e1733; color:#eaf0ff; border-radius:12px; outline:none; }
    input::placeholder { color:#8ea0c8; }
    .row { display:flex; gap:12px; flex-wrap: wrap; }
    .row > * { flex: 1 1 220px; }
    .btns { display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
    button { padding: 10px 16px; border-radius: 12px; border: 1px solid #2a3355; background:#1a2550; color:#eaf0ff; cursor:pointer; font-weight:600; }
    button:hover { filter: brightness(1.1); }
    .result { margin-top:18px; padding:16px; background:#0e1733; border:1px solid #2a3355; border-radius:12px; }
    .grid { width:100%; border-collapse: collapse; margin-top:12px; }
    .grid th, .grid td { border:1px solid #2a3355; padding:8px 10px; text-align:center; }
    .muted { color:#a9b5d1; font-size: 14px; }
    .badge { display:inline-block; padding:4px 10px; border-radius:999px; border:1px solid #2a3355; background:#15204a; }
    .ok { color:#7ef49a; }
    .warn { color:#ffca6a; }
    .err { color:#ff8c8c; }
    .flex { display:flex; gap:12px; flex-wrap:wrap; align-items:center; }
    .small { font-size: 12px; }
  </style>
</head>
<body>
  <div class="app">
    <h1>Grade Calculator (Marks → Letter + GPA)</h1>
    <p class="sub">বাংলাদেশের সাধারণ গ্রেডিং (A+, A, A-, B, C, D, F) ধরেই বানানো। এক বা একাধিক সাবজেক্টের নম্বর দিলে গড় (Average) ধরে ফাইনাল গ্রেড দেখাবে।</p>

    <div class="field">
      <label for="marks">Marks (0–100): একাধিক দিলে কমা ব্যবহার করুন</label>
      <input id="marks" type="text" placeholder="উদাহরণ: 85, 74, 66, 91" />
      <div class="muted small">Tip: শুধু একটি সাবজেক্ট দিলেও কাজ করবে।</div>
    </div>

    <div class="row">
      <div class="field">
        <label for="passMark">Pass mark (ডিফল্ট 33)</label>
        <input id="passMark" type="number" min="0" max="100" value="33" />
      </div>
      <div class="field">
        <label>Scale</label>
        <div class="muted small">A+ ≥ 80, A ≥ 70, A- ≥ 60, B ≥ 50, C ≥ 40, D ≥ 33, F &lt; 33</div>
      </div>
    </div>

    <div class="btns">
      <button onclick="calculate()">Calculate Grade</button>
      <button onclick="demo()">Fill Demo</button>
      <button onclick="resetAll()">Reset</button>
    </div>

    <div id="errors" class="result" style="display:none"></div>
    <div id="output" class="result" style="display:none"></div>
  </div>

  <script>
    function parseMarks(raw) {
      if (!raw) return [];
      return raw
        .split(/[,\s]+/) // split by comma or spaces
        .filter(Boolean)
        .map(x => Number(x))
        .filter(x => !Number.isNaN(x));
    }

    function validateMarks(arr) {
      const bad = [];
      arr.forEach((m, i) => {
        if (m < 0 || m > 100) bad.push({ index: i + 1, value: m });
      });
      return bad;
    }

    // Bangladesh-style grade bands
    function gradeFromMarks(m, pass = 33) {
      if (m < pass) return { letter: 'F', gpa: 0.0, remark: 'Fail' };
      if (m >= 80) return { letter: 'A+', gpa: 5.0, remark: 'Excellent' };
      if (m >= 70) return { letter: 'A',  gpa: 4.0, remark: 'Very Good' };
      if (m >= 60) return { letter: 'A-', gpa: 3.5, remark: 'Good' };
      if (m >= 50) return { letter: 'B',  gpa: 3.0, remark: 'Satisfactory' };
      if (m >= 40) return { letter: 'C',  gpa: 2.0, remark: 'Passable' };
      // m >= pass handled above
      return { letter: 'D', gpa: 1.0, remark: 'Barely Pass' };
    }

    function aggregate(arr) {
      const total = arr.reduce((a,b) => a + b, 0);
      const avg = arr.length ? total / arr.length : 0;
      const min = arr.length ? Math.min(...arr) : 0;
      const max = arr.length ? Math.max(...arr) : 0;
      return { total, avg, min, max };
    }

    function fmt(n) {
      return Number.isInteger(n) ? String(n) : n.toFixed(2);
    }

    function calculate() {
      const raw = document.getElementById('marks').value.trim();
      const passVal = Number(document.getElementById('passMark').value || 33);
      const errorsBox = document.getElementById('errors');
      const out = document.getElementById('output');

      errorsBox.style.display = 'none';
      out.style.display = 'none';
      errorsBox.innerHTML = '';
      out.innerHTML = '';

      const marks = parseMarks(raw);
      if (!marks.length) {
        showError('Please enter at least one valid mark (0–100). উদাহরণ: 85, 74, 66');
        return;
      }

      const invalid = validateMarks(marks);
      if (invalid.length) {
        const items = invalid.map(e => `#${e.index}: ${e.value}`).join(', ');
        showError(`Invalid marks (must be 0–100): ${items}`);
        return;
      }

      // Subject-wise grades
      const rows = marks.map((m, i) => {
        const g = gradeFromMarks(m, passVal);
        return `<tr><td>${i + 1}</td><td>${fmt(m)}</td><td>${g.letter}</td><td>${g.gpa}</td><td>${g.remark}</td></tr>`;
      }).join('');

      // Overall based on average
      const { total, avg, min, max } = aggregate(marks);
      const overall = gradeFromMarks(avg, passVal);

      out.innerHTML = `
        <div class="flex">
          <div class="badge">Subjects: <strong>${marks.length}</strong></div>
          <div class="badge">Total: <strong>${fmt(total)}</strong></div>
          <div class="badge">Average: <strong>${fmt(avg)}</strong></div>
          <div class="badge">Min: <strong>${fmt(min)}</strong></div>
          <div class="badge">Max: <strong>${fmt(max)}</strong></div>
        </div>

        <table class="grid">
          <thead>
            <tr>
              <th>#</th>
              <th>Marks</th>
              <th>Letter</th>
              <th>GPA</th>
              <th>Remark</th>
            </tr>
          </thead>
          <tbody>${rows}</tbody>
        </table>

        <div style="margin-top:14px">
          <strong>Overall (by Average):</strong>
          <span class="badge">Grade: ${overall.letter}</span>
          <span class="badge">GPA: ${overall.gpa}</span>
          <span class="badge ${overall.letter==='F'?'err':'ok'}">${overall.remark}</span>
        </div>

        <div class="muted small" style="margin-top:8px">নোট: ফাইনাল গ্রেড এখানে গড় নম্বরের ভিত্তিতে। প্রয়োজনে আপনি নিজের নিয়মে পরিবর্তন করতে কোডে gradeFromMarks() ফাংশনের রেঞ্জ বদলে নিতে পারেন।</div>
      `;

      out.style.display = 'block';

      function showError(msg) {
        errorsBox.innerHTML = `<div class="err">⚠️ ${msg}</div>`;
        errorsBox.style.display = 'block';
      }
    }

    function demo() {
      document.getElementById('marks').value = '85, 74, 66, 91, 59';
      document.getElementById('passMark').value = '33';
      calculate();
    }

    function resetAll() {
      document.getElementById('marks').value = '';
      document.getElementById('passMark').value = '33';
      document.getElementById('errors').style.display = 'none';
      document.getElementById('output').style.display = 'none';
      document.getElementById('errors').innerHTML = '';
      document.getElementById('output').innerHTML = '';
    }
  </script>
</body>
</html>
